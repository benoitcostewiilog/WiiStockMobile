<ion-content padding>
    <div class="page-title" *ngIf="livraison">
        <h4>Livraison {{livraison.numero}}</h4>
        <p>Emplacement de destination<br/>{{livraison.emplacement}}</p>
    </div>

    <div class="spinner" *ngIf="loadingStartLivraison">
        <ion-spinner></ion-spinner>
    </div>

    <ng-template #articleTemplate let-article='article'>
        <ion-row>
            <ion-col>
                <p>Label : {{ article.label }}</p>
                <p *ngIf="article.barcode">Code barre : {{ article.barcode }}</p>
                <p *ngIf="article.emplacement && article.emplacement !== 'null'">Emplacement : {{ article.emplacement }}</p>
                <p>Quantité : {{ article.quantite }}</p>
            </ion-col>
        </ion-row>
    </ng-template>

    <div *ngIf="!loadingStartLivraison && articlesNT && articlesNT.length > 0">
        <div class="d-flex">
            <p>Flashez les articles</p>
            <ion-icon item-right name="barcode"> </ion-icon>
        </div>
        <ion-list>
            <ion-grid>
                <button [disabled]="!isValid" (click)="testIfBarcodeEquals(article, false)" class="list" ion-item *ngFor="let article of articlesNT">
                    <ng-container [ngTemplateOutlet]="articleTemplate"
                                  [ngTemplateOutletContext]="{article: article}">
                    </ng-container>
                </button>
            </ion-grid>
        </ion-list>
    </div>

    <div *ngIf="!loadingStartLivraison && articlesT && articlesT.length > 0">
        <div class="d-flex">
            <p>Liste des articles traités</p>
        </div>

        <ion-list>
            <ion-grid>
                <button [disabled]="!isValid" class="list" ion-item *ngFor="let article of articlesT">
                    <ng-container [ngTemplateOutlet]="articleTemplate"
                                  [ngTemplateOutletContext]="{article: article}">
                    </ng-container>
                </button>
            </ion-grid>
        </ion-list>
    </div>
</ion-content>
<ion-footer padding>
    <div class="d-flex">
        <ion-icon class="big-icon" name="qr-scanner" (click)="scan()" [hidden]="articlesNT && articlesNT.length === 0"></ion-icon>
        <ion-icon class="big-icon" item-right name="checkmark-circle" (click)="validate()" [class.alert]="articlesNT && articlesNT.length === 0"></ion-icon>
    </div>
</ion-footer>
